version 3 using perplexity
